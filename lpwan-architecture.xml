<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.3.28 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>

<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc toc="yes"?>

<rfc ipr="trust200902" docName="draft-ietf-lpwan-coap-static-context-hc-15" category="std">

  <front>
    <title abbrev="LPWAN CoAP compression">LPWAN Static Context Header Compression (SCHC) for CoAP</title>

    <author initials="A." surname="Pelov" fullname="Alexander Pelov">
      <organization>Acklio</organization>
      <address>
        <postal>
          <street>1137A avenue des Champs Blancs</street>
          <city>35510 Cesson-Sevigne Cedex</city>
          <country>France</country>
        </postal>
        <email>a@ackl.io</email>
      </address>
    </author>
    <author initials="P." surname="Thubert" fullname="Pascal Thubert">
      <organization>Cisco Systems</organization>
      <address>
        <postal>
          <street>45 Allee des Ormes - BP1200</street>
          <city>06254 Mougins - Sophia Antipolis</city>
          <country>France</country>
        </postal>
        <email>pthubert@cisco.com</email>
      </address>
    </author>
    <author initials="A." surname="Minaburo" fullname="Ana Minaburo">
      <organization>Acklio</organization>
      <address>
        <postal>
          <street>1137A avenue des Champs Blancs</street>
          <city>35510 Cesson-Sevigne Cedex</city>
          <country>France</country>
        </postal>
        <email>ana@ackl.io</email>
      </address>
    </author>

    <date year="2021" month="April" day="28"/>

    
    <workgroup>lpwan Working Group</workgroup>
    

    <abstract>


<t>This document defines the SCHC architecture.</t>



    </abstract>


  </front>

  <middle>


<section anchor="Introduction" title="Introduction">

<t>The base operation and the definition of the SCHC compression &amp; Fragmentation are now described in several documents published by the LPWAN working group.</t>

<t>Among them:</t>

<t><list style="symbols">
  <t>The <xref target="rfc8724"/> defines the generic compression and fragmentation mechanisms for SCHC and applies it to IPv6 and UDP.</t>
  <t>The <xref target="I-D.ietf-lpwan-coap-static-context-hc"/> extend the compression to CoAP and OSCORE.</t>
  <t>The <xref target="I-D.ietf-lpwan-schc-yang-data-model"/> defines a rule representation using the YANG formalism.</t>
</list></t>

<t>As <xref target="I-D.ietf-lpwan-coap-static-context-hc"/> states, the SCHC compression and fragmentation mechanism can be implemented at different levels and/or managed by different organizations.
For instance, as represented figure <xref target="Fig-SCHCCOAP2"/>, IP compression and fragmentation may be managed by the network SCHC instance and end-to-end  compression between the device and the application. The former can itself be split in two instances since encryption
hides the field structure.</t>

<figure title="Different SCHC instances in a global system" anchor="Fig-SCHCCOAP2"><artwork><![CDATA[
         (device)            (NGW)                              (App)

         +--------+                                           +--------+
  A S    |  CoAP  |                                           |  CoAP  |
  p C    |  inner |                                           |  inner |
  p H    +--------+                                           +--------+
  . V    |  SCHC  |                                           |  SCHC  |
         |  inner |   cryptographical boundary                |  inner |
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  A S    |  CoAP  |                                           |  CoAP  |
  p C    |  outer |                                           |  outer |
  p H    +--------+                                           +--------+
  . C    |  SCHC  |                                           |  SCHC  |
         |  outer |   functional boundary                     |  outer |
 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  N      .  udp   .                                           .  udp   .
  e      ..........     ..................                    ..........
  t      .  ipv6  .     .      ipv6      .                    .  ipv6  .
  w C    ..........     ..................                    ..........
  o S    .  schc  .     .  schc  .       .                    .        .
  r H    ..........     ..........       .                    .        .
  k C    .  lpwan .     . lpwan  .       .                    .        .
         ..........     ..................                    ..........
             ((((LPWAN))))             ------   Internet  ------

                Figure 3: OSCORE compression/decompression.
                               
]]></artwork></figure>

<t>This document defines a generic architecture for SCHC that can be used at any of these levels.
The goal of the architectural document is to orchestrate the different protocols and data model
defined by the LPWAN woeking group to design an operational and interoperable<vspace />
framework for allowing IP application over contrained networks.</t>

</section>
<section anchor="definitions" title="Definitions">

</section>
<section anchor="global-architecture" title="Global architecture">

<t>As described in  <xref target="rfc8724"/> a SCHC service is composed of a Parser, analyzing 
packets and creating a list of fields what will be used to match against the compression
rules. If a packet matches rules, compression can be applied following rules instructions.</t>

<t>If SCHC compressed packet is too large to be send in a single L2 frame, fragmentation 
will apply. The process is similar, device rules are checked to find the most appropriate
fragmentation rule, regarding the SCHC packet size, the link error rate, the reliability 
required by the application, …</t>

<t>On the other direction, when a packet SCHC arrives, the ruleID is used to find the rule.
Its nature allows to select if it is a compression or fragmentation rule.</t>

<t>The rule database contains a set of rules specific to a single device. The <xref target="rfc8724"/> 
indicates that the SCHC instance reads the rules to process C/D and F/R, rules are not 
modified during these actions.</t>

<t>A SCHC instance, summarized in the <xref target="Fig-Glob-Arch1"/>, implies C/D and F/R present in both end.
The device connected to a constrained network is in one end and the other end
is either located in the core network or at the application.</t>

<t>In any cases, the rules must be the same in both ends to perform C/D and F/R.</t>

<figure title="Summarized SCHC elements" anchor="Fig-Glob-Arch1"><artwork><![CDATA[
    (device)                                 (core|app) 

     (---)                                     (---)
     ( r )                                     ( r )
     (---)                                     (---)
        . read                                   . read
        .                                        .
     +-----+                                  +-----+ 
 <===| R&D |<=..............................<=| C&F |<===
 ===>| C&F |=>..............................=>| R&D |===>
     +-----+                                  +-----+   


]]></artwork></figure>

<t>To enable rule synchronization between both ends, a common rule representation must be defined.</t>

</section>
<section anchor="data-management" title="Data management">

<t><xref target="I-D.ietf-lpwan-schc-yang-data-model"/> defines an YANG data model to represent the rules. This enables the use of several protocols for rule management, such as NETCONF, RESTCONF and CORECONF. NETCONF uses SSH, RESTCONF uses HTTPS, and CORECONF uses CoAP(s) as their respective transport layer protocols. The data is represented in XML under NETCONF, in JSON under RESTCONF and in CBOR under CORECONF.</t>

<figure title="Summerized SCHC elements" anchor="Fig-RM"><artwork><![CDATA[
                  create
       (-------)  read   +=======+ *
       ( rules )<------->|Rule   |<--|-------->
       (-------)  update |Manager|   NETCONF, RESTCONF or CORECONF
          . read  delete +=======+   request
          .
       +-------+ 
   <===| R & D |<===
   ===>| C & F |===>
       +-------+
]]></artwork></figure>

<t>Rule Manager (RM) is in charge of handling data derived from the YANG Data Model and apply changes to the rules database <xref target="Fig-RM"/>.</t>

<t>The RM is a application using the Internet to exchange information, therefore:</t>

<t><list style="symbols">
  <t>for the network-level SCHC, the communication does not require routing. Each of the end-points having an RM and both RMs can be viewed on the same link, therefore wellknown Link Local addresses can be used to identify the device and the core RM. L2 security MAY be deemed as sufficient, if it provides the necessary level of protection.</t>
  <t>for application-level SCHC, routing is involved and global IP addresses SHOULD be used. End-to-end encryption is recommended.</t>
</list></t>

<t>Management messages can also be carried in the negotiation protocol as proposed in <xref target="I-D.thubert-lpwan-schc-over-ppp"/></t>

<t>The RM traffic may be itself compressed by SCHC, especially if CORECONF is used, <xref target="I-D.ietf-lpwan-coap-static-context-hc"/> can be used.</t>

</section>
<section anchor="acknowledgements" title="Acknowledgements">

<t>The authors would like to thank (in alphabetic order):</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="rfc8724" target='https://www.rfc-editor.org/info/rfc8724'>
<front>
<title>SCHC: Generic Framework for Static Context Header Compression and Fragmentation</title>
<author initials='A.' surname='Minaburo' fullname='A. Minaburo'><organization /></author>
<author initials='L.' surname='Toutain' fullname='L. Toutain'><organization /></author>
<author initials='C.' surname='Gomez' fullname='C. Gomez'><organization /></author>
<author initials='D.' surname='Barthel' fullname='D. Barthel'><organization /></author>
<author initials='JC.' surname='Zúñiga' fullname='JC. Zúñiga'><organization /></author>
<date year='2020' month='April' />
<abstract><t>This document defines the Static Context Header Compression and fragmentation (SCHC) framework, which provides both a header compression mechanism and an optional fragmentation mechanism. SCHC has been designed with Low-Power Wide Area Networks (LPWANs) in mind.</t><t>SCHC compression is based on a common static context stored both in the LPWAN device and in the network infrastructure side. This document defines a generic header compression mechanism and its application to compress IPv6/UDP headers.</t><t>This document also specifies an optional fragmentation and reassembly mechanism. It can be used to support the IPv6 MTU requirement over the LPWAN technologies. Fragmentation is needed for IPv6 datagrams that, after SCHC compression or when such compression was not possible, still exceed the Layer 2 maximum payload size.</t><t>The SCHC header compression and fragmentation mechanisms are independent of the specific LPWAN technology over which they are used. This document defines generic functionalities and offers flexibility with regard to parameter settings and mechanism choices. This document standardizes the exchange over the LPWAN between two SCHC entities. Settings and choices specific to a technology or a product are expected to be grouped into profiles, which are specified in other documents. Data models for the context and profiles are out of scope.</t></abstract>
</front>
<seriesInfo name='RFC' value='8724'/>
<seriesInfo name='DOI' value='10.17487/RFC8724'/>
</reference>



<reference anchor="I-D.ietf-lpwan-schc-yang-data-model">
<front>
<title>Data Model for Static Context Header Compression (SCHC)</title>
<author initials='A' surname='Minaburo' fullname='Ana Minaburo'>
<organization />
</author>
<author initials='L' surname='Toutain' fullname='Laurent Toutain'>
<organization />
</author>
<date year='2021' month='February' day='02' />
<abstract><t>This document describes a YANG data model for the SCHC (Static Context Header Compression) compression and fragmentation rules.</t></abstract>
</front>
<seriesInfo name='Internet-Draft' value='draft-ietf-lpwan-schc-yang-data-model-04'/>
<format type='TXT' target='https://www.ietf.org/internet-drafts/draft-ietf-lpwan-schc-yang-data-model-04.txt'/>
</reference>



<reference anchor="I-D.ietf-lpwan-coap-static-context-hc">
<front>
<title>LPWAN Static Context Header Compression (SCHC) for CoAP</title>
<author initials='A' surname='Minaburo' fullname='Ana Minaburo'>
<organization />
</author>
<author initials='L' surname='Toutain' fullname='Laurent Toutain'>
<organization />
</author>
<author initials='R' surname='Andreasen' fullname='Ricardo Andreasen'>
<organization />
</author>
<date year='2021' month='March' day='08' />
<abstract><t>This draft defines how to compress the Constrained Application Protocol (CoAP) using the Static Context Header Compression (SCHC). SCHC is a header compression mechanism adapted for Constrained Devices.  SCHC uses a static description of the header to reduce the header's redundancy and size.  While RFC 8724 describes the SCHC compression and fragmentation framework, and its application for IPv6/UDP headers, this document applies SCHC for CoAP headers.  The CoAP header structure differs from IPv6 and UDP since CoAP uses a flexible header with a variable number of options, themselves of variable length.  The CoAP protocol messages format is asymmetric: the request messages have a header format different from the one in the response messages.  This specification gives guidance on applying SCHC to flexible headers and how to leverage the asymmetry for more efficient compression Rules.</t></abstract>
</front>
<seriesInfo name='Internet-Draft' value='draft-ietf-lpwan-coap-static-context-hc-19'/>
<format type='TXT' target='https://www.ietf.org/internet-drafts/draft-ietf-lpwan-coap-static-context-hc-19.txt'/>
</reference>



<reference anchor="I-D.thubert-lpwan-schc-over-ppp">
<front>
<title>SCHC over PPP</title>

<author initials='P' surname='Thubert' fullname='Pascal Thubert'>
    <organization />
</author>

<date month='June' day='4' year='2020' />

<abstract><t>This document extends RFC 5172 to signal the use of SCHC as the compression method between a pair of nodes over PPP.  Combined with RFC 2516, this enables the use of SCHC over Ethernet and Wi-Fi.</t></abstract>

</front>

<seriesInfo name='Internet-Draft' value='draft-thubert-lpwan-schc-over-ppp-01' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-thubert-lpwan-schc-over-ppp-01.txt' />
</reference>




    </references>





  </back>

<!-- ##markdown-source:
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
DZkCKZYfAAA=

-->

</rfc>

